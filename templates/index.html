{% extends 'main.html' %}
{% block headextra %}
    <script type="text/javascript">
jQuery(document).ready(function() {


    $('#searchtext').keypress(function(e){
      if(e.keyCode==13)
      $('#searchbutton').click();
    });



$(document).on('click','#json_file',function(e){
  var json_file=$('#json_file').val();
    if (json_file!=null) {
            var sk=$('#searchtext').val();

        window.location.href = "/details?json_file=" + json_file+"&sk="+sk;
    }
    });




    jQuery('#searchbutton').on('click', function(e)  {
    var sk=$('#searchtext').val();

if(jQuery.trim(sk).length <= 0)
{
    $('#info').show();
    $('#info').text('Enter keyword to search...');
    return
}

        $.ajax({
        type: "GET",
        url: "search",
        data: {sk:sk},


        success: function(result) {
        if(result.hasOwnProperty('error')){
            $('#info').show();
            $('#info').text(result['error']);
            $('#choice').html("<div id=\"choice\"><select name=\"json_file\" size=\"10\" id=\"json_file\"></select></div>");

            }
            else {
            var search_info="<div id=\"choice\"><select name=\"json_file\" id=\"json_file\" size=\"10\">"
            $.each(result, function (key, value) {
                search_info+="<option value=\""+key+"\">"+value+"</option>"
            });
            $('#info').hide();

            search_info+="</select></div>"
            $('#choice').html(search_info);


        }
            $('#page2').addClass('hidden');
            $('#page1').removeClass('hidden');
    },
        error: function(err) {
        alert(err.toString());

    }
});
    });



function show(index)
  {
var section=document.getElementById('section'+index).innerHTML;
      if (section)
$("textarea#section_area").val(section);

  }
function showtab(name) {
    var value = document.getElementById(name).innerHTML;
    if (value)
        $("textarea#extra_area").val(value);
}
show(1);
    showtab('Summary');

    jQuery('#first').on('click', function(e)  {
        var value = document.getElementById('num_first').innerHTML;
        show(value);
        document.getElementById('current').innerHTML=value;

    });
    jQuery('#last').on('click', function(e)  {
        var value = parseInt(document.getElementById('num_last').innerHTML);
        show(value);
        document.getElementById('current').innerHTML=value;
    });

    jQuery('#next').on('click', function(e)  {

        var value = parseInt(document.getElementById('current').innerHTML)+1;
        var last = parseInt(document.getElementById('num_last').innerHTML);
        if (value<=last) {
            show(value);
            document.getElementById('current').innerHTML = value;
        }
        });
    jQuery('#previous').on('click', function(e)  {
       var value = parseInt(document.getElementById('current').innerHTML)-1;
        var first = parseInt(document.getElementById('num_first').innerHTML);
        if (value>=first) {
            show(value);
            document.getElementById('current').innerHTML = value;
        }
        });

    jQuery('input.tabs').on('click', function(e)  {

        // Show/Hide Tabs

    $( "input.tabs" ).removeClass( "active" )
    $( this ).addClass( "active" );
        var attrib=$(this).attr("value");
        document.getElementById('tabs').innerHTML=attrib;

        showtab(attrib)

if(param)
      $("textarea#extra_area").val(param);


        e.preventDefault();
    });



});
        </script>
{% endblock %}
{% block content %}


    <br/>
    <table width='100%' cellspacing="6">
    <tr>

        <td width="70%"><input type="text" class="searchbox" id="searchtext" name="searchtext" value='{{ sk }}' /></td>

        <td width="15%"><input class="btn" type="button" id="searchbutton" name="searchbutton" value="Search" /></td>

        <td width="15%"><input class="btn" type="button" id="plus" value="+" /></td>
    </tr>
    <tr>
        <td colspan="3">
        <div id="info" style="color:white;">


        </div>
        </td>
    </tr>
        <tr>
        <td >
            {% if page==1 %}
<div id="page1">
{% else %}
   <div id="page1" class="hidden">
   {% endif %}
           <div id="choice">


  <select name="json_file" id="json_file" size="10">

   </select>

</div>
        </div>

        </td>

    </tr>




    <tr>
<td >
        <table width="100%" style="width:100%;border:0;border-collapse: collapse">
<tr>
        <td  width="60%" style="color: white;">{{ selected_info }}</td>

        <td width="10%" ><input class="btn" type="button" id="first" value="<<" /></td>
        <td width="10%" ><input class="btn" type="button" id="previous" value="<" /></td>
        <td width="10%" ><input class="btn" type="button" id="next" value=">" /></td>

        <td width="10%" ><input class="btn" type="button" id="last" value=">>" /></td>
</tr>
            </table>
        </td>
    </tr>
    <tr>
        <td  width="70%">
        <textarea rows="10" cols="48" id="section_area">

</textarea>
        </td>
        </tr>


    </table>



    </ol>


    {% if page==2 %}
    <div id="page2">
{% else %}

    <div id="page2" class="hidden">
{% endif %}
{% for section in section_text %}
{% if loop.first %}
    <div id="num_first" class="hidden">{{ loop.index }}</div>
    <div id="Summary" class="hidden">{{ Summary }}</div>

    <div id="Links" class="hidden">{{ Links }}</div>

    <div id="Hierarchy" class="hidden">{{ Hierarchy }}</div>
    <div id="Rep" class="hidden">{{ Rep }}</div>
    <div id="Inferences" class="hidden">{{ Inferences }}</div>
    <div id="Stats" class="hidden">{{ Stats }}</div>

    <div id="current" class="hidden">{{ loop.index }}</div>
    <div id="tabs" class="hidden">Summary</div>

{% endif %}
<div id='section{{ loop.index }}' class='section'>{{ section.section_text}}</div>
    {% if loop.last %}
    <div id="num_last" class="hidden">{{ loop.index }}</div>
    {% endif %}
    {#
    <div id='sentence{{ loop.index }}' class="sentence">
        {% for sec in section.sentences %}
        {{ sec }}
        {% endfor %}
    </div>
#}
{% endfor %}


    <!--table width="75%">

    <tr>
<td>
        <table>
            <tr colspan="2">

        <td width="45%" style="color: white;">{{ selected_info }}</td>
        <td width="5%" align="right"><input class="btn" type="button" id="first" value="<<" style="width:100%"/></td>
        <td width="5%" align="right"><input class="btn" type="button" id="previous" value="<" style="width:100%" /></td>
        <td width="5%" align="right"><input class="btn" type="button" id="next" value=">" style="width:100%"/></td>

        <td  width="5%" align="right"><input class="btn" type="button" id="last" value=">>" style="width:100%"/></td>
</tr>
        </table>
            </td>
    </tr>
    <tr>
        <td colspan="5" width="65%">
        <textarea rows="10" cols="49" id="section_area">

</textarea>
        </td>
        </tr>






    </table-->
    <br/>

<table width="70%">
<tr>
         <td ><input class="btn tabs active" type="button" id="summary" value="Summary" /></td>
        <td ><input class="btn tabs " type="button" id="links" value="Links"  /></td>
        <td ><input class="btn tabs" type="button" id="inferences" value="Inferences" /></td>

        <td ><input class="btn tabs" type="button" id="hierarchy" value="Hierarchy" /></td>
        <td ><input class="btn tabs" type="button" id="rep" value="Rep" /></td>
        <td ><input class="btn tabs" type="button" id="stats" value="Stats" /></td>

        </tr>
    <tr>
<td colspan="5" width="60%">
        <textarea rows=12 cols="49" id="extra_area" style="background:#c2c2c2;">

</textarea>
        </td>
</tr>
</table>

    </div>






{% endblock %}
